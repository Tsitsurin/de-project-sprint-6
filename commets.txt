Привет, Светлана.

Спасибо за замечания! Я все поправил

Я только не понимаю как CTE user_group_messages можно реализовать через 2 джоина.
Потому что по условию задачи нужно hk_group_id и еще user_id(который есть только в хабе h_users)
И при этом еще соблюсти жесткое ограничение на наличие хотя бы одного сообщения у пользователя(связь линке l_user_message)